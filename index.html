<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>Program Editor</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">

    <!-- jQuery daterangepicker, jQuery timepicker, & Dragula -->
    <link href="./dependencies/jquery-daterange-picker/daterangepicker.min.css" rel="stylesheet" />
    <link href="./dependencies/jquery-timepicker/jquery.timepicker.css" rel="stylesheet" />
    <link href="./dependencies/dragula/dragula.css" rel="stylesheet" />

    <!-- Styling: Custom -->
    <link href="./styles/main.css?v=2" rel="stylesheet" />
    <link href="https://iacr.org/libs/fonts/raleway-regular.css" rel="stylesheet"/>
    <link href="https://iacr.org/libs/fonts/open-sans-condensed.css" rel="stylesheet"/>
    <style>
     .sessionlist {
       margin-top: 3px;
       margin-bottom: 3px;
     }
     .session, .tab-content > .active {
       background-color: #dee2e6;
     }
     .nav-tabs .nav-item.show .nav-link, .nav-tabs .nav-link.active {
       background-color: #dee2e6;
     }
     .sessionlist .nav-tabs .nav-link {
       border-bottom: none;
     }
     .session:first-child:nth-last-child(1) {
       /* -or- .session:only-child { */
       width: 100%;
     }
     /* two sessions */
     .session:first-child:nth-last-child(2),
     .session:first-child:nth-last-child(2) ~ .session {
       width: 50%;
     }
     /* first session of two. */
     .session:first-child:nth-last-child(2) {
       margin-right: .35rem;
     }
     /* second session of two. */
     .session:first-child:nth-last-child(2) ~ .session {
       margin-left: .35rem;
     }
    </style>
    <!-- Bootstrap scripts -->
    <script src="https://iacr.org/libs/js/jquery/3.3.1/jquery.min.js"></script>
    <noscript><h1>This tool will not work without javascript.</h1></noscript>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>

  </head>
  <body>
    <nav class="navbar navbar-expand navbar-custom" id="topNav" role="navigation">
      <div class="container-fluid me-5">
        <span class="navbar-brand" id="navBrand">Program Creator</span>
        <span class="navbar-text ms-auto" id="save_status"></span>
        <ul class="navbar-nav" id="topNavList">
          <li role="button" class="nav-item dropdown">
            <!-- NOTE/TODO: turns out dropdowns don't have to be anchors (as they did in Bootstrap 3.3); they can be buttons. which I tested and works beautifully with added .btn -->
            <a class="nav-link dropdown-toggle" href="#" id="fileDD" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              File
            </a>
            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="fileDD">
              <a id="openMenu" onclick="navigateToHome()" class="dropdown-item">
                Open
              </a>
              <a id="editMetadataMenu" onclick="showEditMetadata();" class="dropdown-item">
                Edit name and dates
              </a>
              <a id="saveMenu" onclick="saveProgram();" class="dropdown-item">
                Save (autosave ON)
              </a>
              <a id="saveAsMenu" onclick="saveAs();" class="dropdown-item">
                Save a copy...
              </a>
              <a id="deleteMenu" onclick="showDeleteProgram();" class="dropdown-item">
                Delete from server
              </a>
            </div>
          </li>
          <li role="button" class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="downloadDD" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Download
            </a>
            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="downloadDD">
              <a id="downloadMenu" onclick="downloadJSON()" class="dropdown-item">
                Download JSON for website
              </a>
              <!-- <a id="downloadPDFMenu" onclick="showPDFDownload()" class="dropdown-item">
                Download PDF for printing
              </a> -->
            </div>
          </li>
          <li role="button" class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="importDD" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Import
            </a>
            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="importDD">
              <a id="importTalksMenu" onclick="showImportFSEorCHES(true)" class="dropdown-item">
                Import from TCHES or ToSC
              </a>
              <a id="uploadTalksMenu" onclick="showWebsubrevUpload(true)" class="dropdown-item">
                Upload accepted papers
              </a>
              <a id="importDOIMenu" onclick="startImportDOIs()" class="dropdown-item">
                Import paper URLs
              </a>
            </div>
          </li>
          <li class="nav-item">
            <a target="_help" href="docs/help.html" class="nav-link">
              Help
            </a>
          </li>
          <li class="nav-item">
            <a target="_help" href="https://github.com/kaymckelly/program-editor" class="nav-link">
              About
            </a>
          </li>
          <li role="button" class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="loginDD" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <img src="img/md-person.svg">
            </a>
            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="loginDD" style="right: 0 !important; left auto !important">
              <span class="dropdown-item navbar-text" id="login_status">
                Login status unknown
              </span>
              <a id="loginMenu" onClick="$('#authModal').modal();this.blur()" class="dropdown-item">
                Log in
              </a>
              <a id="logoutMenu" onclick="doLogout()" class="dropdown-item">
                Log out
              </a>
            </div>
          </li>
        </ul>
      </div>
    </nav>

    <div class="container">
      <div id="setupPrompts">
        <div class="row">
          <section class="col-md-12 setupStep instructions">
            <p class="text-justify">
              This app allows you to create a program for a conference. The things you need to
              get started are the dates of your conference and the list of accepted papers
              from HotCRP (you could type those in again, but why bother?). The list of
              accepted papers is accessible as a JSON file from the program chair interface.
            </p>
<!--            <p class="alert alert-info">
              NOTE: for virtual conferences, times should be entered in UTC
            </p>-->
          </section>
        </div>
        <!-- Button to trigger login modal -->
        <div class="row" id="auth-button">
          <div class="col-md-8">
            <button type="button" class="btn btn-success btn-lg" data-bs-toggle="modal" data-bs-target="#authModal">
              Log in for this app
            </button>
          </div>
        </div>
        <div class="row">
          <section id="newOrExisting" class="col-12 setupStep">
            <p>
              If you've been here before, you can edit an existing program. Otherwise, start from a new one. If you open a 
              program that is owned by
              someone else, you cannot overwrite their work but you can save an edited copy to your account.
            </p>
            <div class="row">
              <div class="col-12">
                <button type="button" name="newProg" onclick="createNew();this.blur()" class="btn btn-success btn-sm mr-2">
                  New
                </button>
                <button type="button" name="existingProg" onclick="editExisting();this.blur()" class="btn btn-success btn-sm">
                  Existing
                </button>
              </div>
              <!-- <div class="col-md-6">
                   <input class="form-control input-sm" type="text" placeholder="Search for a program (not yet working)">
                   </div> -->
            </div>
          </section>
        </div>

        <div class="w-75">
          <label for="confName">Name of conference</label>
          <input type="text" class="form-control my-1" id="confName" placeholder="Keycrypt 2050" required />

          <label for="confType" class="mt-3">Type of conference</label>
          <select name="confType" id="confType" class="form-select my-1" required aria-describedby="confTypeHelp">
            <option selected disabled></option>
            <optgroup label="IACR events">
              <option value="asiacrypt">Asiacrypt (banquet + IACR business meeting)</option>
              <option value="ches">CHES (banquet)</option>
              <option value="crypto">Crypto (beach barbeque + IACR business meeting)</option>
              <option value="eurocrypt">Eurocrypt (banquet + IACR business meeting)</option>
              <option value="fse">FSE (dinner)</option>
              <option value="pkc">PKC</option>
              <option value="rwc">RWC (lightning talks)</option>
              <option value="tcc">TCC (TCC business meeting)</option>
            </optgroup>
            <optgroup label="Rump sessions and affiliated events">
              <option value="rumpSess">Rump session (split into three parts, 5 minute slots)</option>
              <option value="workshop1">One-day affiliated event or workshop</option>
              <option value="workshop2">Two-day affiliated event or workshop</option>
            </optgroup>
            <optgroup label="Non-specific conference types">
              <option value="basic3Day">Basic three-day conference</option>
              <option value="basic4Day">Basic four-day conference</option>
              <option value="basic5Day">Basic five-day conference</option>
            </optgroup>
          </select><div id="confTypeHelp" class="form-text">
            <strong>If you are an IACR event, you must select the applicable type of event.</strong> 
            All IACR events (with the exception of RWC) by default include a rump session, slots for two 
            invited talks, and a slot for an awards ceremony unless otherwise noted.
          </div>

          <label for="numTrack" class="mt-3">Maximum number of parallel tracks</label>
          <input type="number" id="numTrack" class="form-control my-1" aria-describedby="numTrackHelp" value="2" />
          <div id="numTrackHelp" class="form-text">
            Some sessions will still be single track, but you can edit those later.
          </div>

          <!-- TODO: ideally add default value of now, min val must be now or later -->
          <div class="row">
            <div class="col">
              <label for="startDate" class="mt-3">Start date</label>
              <input type="date" id="startDate" class="form-control my-1" />
            </div>
            <div class="col">
              <label for="endDate" class="mt-3">End date</label>
              <input type="date" id="endDate" class="form-control my-1" />
            </div>
          </div>

          <div class="row">
            <div class="col">
              <label for="city" class="mt-3">City</label>
              <input type="text" id="city" class="form-control my-1" />
            </div>
            <!-- TODO: suggest a select as opposed to an input; seems like an easier experience for the user -->
            <div class="col">
              <label for="country" class="mt-3">Country</label>
              <input type="text" id="country" class="form-control my-1" />
            </div>
          </div>
          <div>

          </div>

          <label for="timezone" class="mt-3">Timezone</label>
          <select name="timezone" id="timezone" class="form-select my-1" aria-describedby="timezoneHelp">
            <option selected></option>
            <!-- TODO: insert timezone names here (from a list), should autopopulate based on city/country/dates -->
          </select>
          <div id="timezoneHelp" class="form-text">
            This is auto-populated based on the dates, city, and country you have entered. You should verify it is 
            correct. If it is incorrect, you can change it manually.
          </div>

          <label for="talkUpload" class="mt-3">Upload or select talks</label>
          <div class="d-flex justify-content-between my-1">
            <button class="btn btn-outline-dark">
              Upload from HotCRP
            </button>
            <button class="btn btn-outline-dark">
              Import from TCHES or ToSC
            </button>
            <button class="btn btn-outline-dark">
              Use demo data
            </button>
            <button class="btn btn-outline-dark">
              Skip for now
            </button>
          </div>
          <div id="talkUploadHelp" class="form-text">
            This is an optional step and can be an upload from HotCRP
            (a JSON file), an import of papers from TCHES or ToSC, or using our demo data.
          </div>
  
          <!-- TODO: remove .mb-5 once page is actually put together -->
          <div class="nextPrevBtns d-flex mt-3 mb-5">
            <button class="btn border border-0 me-2">
              <img src="img/arrow-left.svg" alt="previous">
            </button>
            <button class="btn border border-0">
              <img src="img/arrow-right.svg" alt="next">
            </button>
          </div>
        </div>

        <div class="row">
          <section id="versionPicker" class="col-12 setupStep">
            <table class="table table-bordered" id="versionList">
              <tr>
                <th>Name</th>
                <th>Owner</th>
                <th>Last modified</th>
                <!--                <th><button type="button" class="btn btn-sm btn-disabled">Delete selected</button></th>-->
              </tr>
            </table>
          </section>
        </div>

        <div id="templateSelector">
          <div class="row">
            <section class="col-7 setupStep">
              <select id="templateSelect" class="form-select input-sm" onchange="getConfig(this.value, false)">
                <option value="" disabled selected>
                  Select a template to get started (you can change things later)
                </option>
                <option value="./json/dualhybrid.json">
                  Virtual conference (4 days, dual track)
                </option>
                <option value="./json/three_tracks.json">
                  Four days, three tracks
                </option>
                <option value="./json/virtual_5day.json">
                  Virtual conference (5 days, single track)
                </option>
                <option value="./json/crypto_config.json">
                  Crypto (5 days, dual track, bbq)
                </option>
                <option value="./json/ec_config.json">
                  Eurocrypt/Asiacrypt (5 days, dual track, banquet)
                </option>
                <option value="./json/pkc_config.json">
                  CHES/FSE/PKC/TCC (4 days, single track)
                </option>
                <option value="./json/basic_1day.json">
                  Basic one-day workshop
                </option>
                <option value="./json/basic_2day.json">
                  Basic two-day workshop
                </option>
                <option value="./json/basic_3day.json">
                  Basic three-day conference
                </option>
                <option value="./json/dualtrack_5day.json">
                  Dual track, five days
                </option>
                <option value="./json/rump_session.json">
                  Rump Session (3 sessions, 30 minutes/session)
                </option>
              </select>
            </section>
          </div>
        </div>

        <div id="nameEntry">
          <div class="row">
            <section class="col-7 setupStep">
              <label for="inputName">
                Enter a name for the conference program.
              </label>
              <div class="d-flex">
                <input type="text" name="inputName" id="inputName" class="form-control" />
                <button type="button" name="addName" onclick="addName()" class="btn btn-sm btn-success ml-2">
                  Next
                </button>
              </div>
            </section>
          </div>
        </div>
        <div class="row">
          <section id="timezonePicker" class="col-7 setupStep">
            <label for="timezone">
              Choose a timezone.
            </label>
            <select class="form-select col-6" id="timezone"></select>
          </section>
        </div>
        <div class="row">
          <section id="datePicker" class="mt-3 col-7 setupStep">
            <p>
              Choose the start and end date for your conference.
            </p>
            <div class="row">
              <div class="col-8 d-flex">
                <label for="startdate" class="col-form-label">From</label>
                <input type="text" id="startdate" name="startdate" class="form-control mx-2" />
                <label for="enddate" class="col-form-label">to</label>
                <input type="text" id="enddate" name="enddate" class="form-control ml-2" />
              </div>
            </div>
          </section>
        </div>
        <button type="button" id="datesButton" onclick="showUploadTalks()" class="btn btn-sm btn-success">Set dates &amp; timezone</button>
        <div class="row">
          <section id="uploadTalks" class="col-12 form-group">
            <p>
              Next, specify the list of accepted papers. This can be an upload from HotCRP
              (a JSON file), or you can import accepted papers from TCHES or ToSC.
              You can do this later if you like.
            </p>
            <button type="button" name="showUpload" onclick="showWebsubrevUpload(false)" class="btn btn-sm btn-success mr-2">
              Upload accepted papers
            </button>
            <button type="button" name="showImport" onclick="showImportFSEorCHES(false)" class="btn btn-sm btn-success mr-2">
              Import from ToSC or TCHES
            </button>
            <button type="button" name="skipUpload" onclick="useEmptyTalks()" class="btn btn-sm btn-success mr-2">
              Skip for now
            </button>
            <button type="button" name="useDemoTalks" onclick="useDemoTalks()" class="btn btn-sm btn-success">
              Use demo data
            </button>
          </section>
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <main id="parent" class="mt-4">
        <div class="row">
          <div class="col-md-3">
            <h3 class="text-center editorTitles">
              Unscheduled Talks
              <label data-bs-toggle="tooltip" title="Add a talk" data-bs-placement="top" data-bs-trigger="hover" tabindex="0">
                <span class="addicon"><img src="img/add.svg" onclick="showTalkEditor('')"></span>
              </label>
            </h3>
          </div>
          <div class="col-md-9">
            <h3 class="text-center editorTitles">
              Schedule
              <label data-bs-toggle="tooltip" title="Edit dates" data-bs-placement="top" data-bs-trigger="hover" tabindex="0">
                <span class="addicon"><img src="img/add.svg" onclick="showEditMetadata()"></span>
              </label>
            </h3>
          </div>
        </div>

        <!-- This is a handlebars partial that can be used in two places to display a talk. -->
        <script id="talk-partial" type="text/x-handlebars-template">
          <div class="talk" id="{{id}}">
            <a class="editButton float-end" onclick="showTalkEditor('{{id}}')">
              <label data-bs-toggle="tooltip" title="Edit the talk" data-bs-placement="top" data-bs-trigger="hover" tabindex="0">
                <span class="editIcon"><img src="img/edit.svg"></span>
              </label>
            </a>
            <h4 class="talkTitle">
              {{#if starttime}}({{starttime}}{{#if endtime}}-{{endtime}}{{/if}}){{/if}}
              {{title}}{{#if paperUrl}}&nbsp;&nbsp;<a target="_paper" href="{{paperUrl}}"><span class="talkIcons"><img src="img/md-document.svg" title="View the paper"></span></a>{{/if}}
              {{#if slidesUrl}}&nbsp;&nbsp;<a target="_slides" href="{{slidesUrl}}"><span class="talkIcons"><img src="img/md-desktop.svg" title="View the slides"></span></a>{{/if}}
            </h4>
            {{#if talkNote}}
            <div class="talkNote">
              {{{talkNote}}}
            </div>
            {{/if}}
            <div class="authorList">
              {{#each authors}}
              <span class="authorName">{{this}}</span>
              {{/each}}
            </div>
            {{#if affiliations }}
            <div class="keywords">
              {{affiliations}}
            </div>
            {{/if}}
            {{#if keywords }}
            <div class="keywords">
              Keywords: {{keywords}}
            </div>
            {{/if}}
          </div>
        </script>
        <div class="row">
          <article id="categoryList" class="col-md-3">
            <div id="alertInstr" class="alert alert-light alert-dismissible fade show" role="alert">
              Instructions: Drag talks from the categories below to the sessions on the right. You can edit sessions, talks, time slots, days, etc. When finished, you can export the JSON for the website.
              <button type="button" class="btn-close close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            <section id="talksList">
              <!-- Handlebars script that renders the list of talks based on user-uploaded json file with HotCRP output -->
              <script id="talks-template" type="text/x-handlebars-template">
                <!-- BUG: may have gray outline remaining after click b/c is button rather than anchor, as edit session pencil is -->
                {{#each unassigned_talks}}
                <div class="categoryDiv" id="{{id}}">
                  <a class="editButton float-end" onclick="showCategoryEditor('{{id}}');">
                    <label data-bs-toggle="tooltip" title="Edit the category" data-bs-placement="bottom" data-bs-trigger="hover" tabindex="0">
                      <span class="editIcon"><img src="img/edit.svg"></span>
                    </label>
                  </a>
                  <h4 class="categoryTitle">
                    {{name}}
                  </h4>
                  {{#talkList talks false}}
                  {{#each talks}}
                  {{> talk}}
                  {{/each}}
                  {{/talkList}}
            </section>
                </div>
                {{/each}}
              </script>
          </section>
          <label data-bs-toggle="tooltip" title="Add a Category. These are not used in the program itself." data-bs-placement="top" data-bs-trigger="hover" tabindex="0" z-index="2" id="newCategoryButton">
            <span class="addicon"><img src="img/add.svg" onclick="showCategoryEditor('')"></span>
          </label>
          </article>
          <article id="renderedProgram" class="col-md-9 pt-3">
            <!-- Handlebars script, renders editable program based on the user-selected program template -->
            <script id="program-template" type="text/x-handlebars-template">
              {{#each days}}
              <div class="row">
                <div class="col-md-5">
                  <h4 class="pageSubtitle">
                    {{formatDate date}} <label data-bs-toggle="tooltip" title="Add a time slot" data-bs-placement="top" data-bs-trigger="hover" tabindex="0">
                    <span class="addicon"><img src="img/add.svg" onclick="prepareAddTimeslotToDay({{@index}})"></span>
                    </label>
                  </h4>
                </div>
              </div>
              {{#each timeslots}}
              {{#if sessions}} <!-- only render slots that have sessions -->
              <div class="row mb-2">
                <div class="col-md-2 timeSlotDiv">
                  <a class="editButton float-end" onclick="editTimeslot({{@../index}}, {{@index}})">
                    <label data-bs-toggle="tooltip" title="Edit the time slot" data-bs-placement="top" data-bs-trigger="hover" tabindex="0">
                      <span class="editIcon"><img src="img/edit.svg"></span>
                    </label>
                  </a>
                  <br />
                  <p class="timeSlot text-center">
                    {{starttime}}-{{endtime}}
                  </p>
                </div>
                <div class="col-md-10 sessionlist ps-0">
                  {{setTabbed sessions}}
                  {{#if @root.tabbedSessions}}
                  <ul class="nav nav-tabs mt-2" role="tablist">
                    {{#each sessions}}
                    <li class="nav-item {{#if @first}}active{{/if}}" role="presentation">
                      <button id="btn-{{id}}" class="nav-link {{#if @first}}active{{/if}}" href="#{{id}}" data-bs-toggle="tab" data-bs-target="#{{id}}" type="button" role="tab" aria-controls="{{id}}">{{session_title}}</button>
                    </li>
                    {{/each}}
                  </ul>
                  {{/if}}
                  <div class="{{#if @root.tabbedSessions}}tab-content{{else}}d-flex{{/if}}" id="sessions-{{@index}}">
                    {{#each sessions}}
                    <div class="session {{#if @root.tabbedSessions}}tab-pane fade {{#if @first}} active show{{/if}}{{/if}}" id="{{id}}" role="tabpanel" aria-labelled-by="btn-{{id}}">
                      <!-- {{@../../index}} is the day index
                           {{@../index}} is the timeslot index
                           {{@index}} is the session index -->
                      <a class="editButton float-end" onclick="editSession({{@../../index}},{{@../index}},{{@index}})">
                        <label data-bs-toggle="tooltip" title="Edit the session" data-bs-placement="top" data-bs-trigger="hover" tabindex="0">
                          <span class="editIcon"><img src="img/edit.svg"></span>
                        </label>
                      </a>
                      <h4 class="text-center">
                        {{session_title}}
                        {{#if session_url}}&nbsp;&nbsp;<a target="_session" href="{{session_url}}"><img class="infoIcon" title="Additional information" src="img/info.svg"></a>{{/if}}
                      </h4>
                      {{#if location.name}}
                      <div class="text-center">
                        {{location.name}}
                      </div>
                      {{/if}}
                      {{#if moderator}}
                      <div class="text-center">
                        {{moderator}}
                      </div>
                      {{/if}}
                      {{#talkList talks true}}
                      {{#each talks}}
                      {{> talk}}
                      {{/each}}
                      {{/talkList}}
                    </div>
                    {{/each}}
                  </div>
                </div>
              </div>
              {{/if}} <!-- sessions -->
              {{/each}} <!-- timeslots -->
              <hr />
              {{/each}} <!-- days -->
            </script>
          </article>
        </div>
      </main>
    </div>

    <!-- Handlebars templates -->
    <script src="https://iacr.org/libs/js/handlebars/handlebars-v4.1.0.js" type="text/javascript"></script>
    <script>
     // Called at the beginning of a timeslot to set @root.tabbedSessions and @root.twoSessions
     Handlebars.registerHelper('setTabbed', function (sessionlist, options) {
       if (!options.data.root) {
         options.data.root = {};
       }
       options.data.root['twoSessions'] = (sessionlist.length == 2);
       options.data.root['tabbedSessions'] = (sessionlist.length > 2);
     });
    </script>

    <!-- Dependencies (dragula, momentJS, jQuery daterangepicker, jQuery timepicker, & datepair) -->
    <script src="./dependencies/dragula/dragula.js"></script>
    <script src="https://iacr.org/libs/js/moment/moment.min.js"></script>
    <script src="https://iacr.org/libs/js/moment/moment-timezone-with-data-10-year-range.js"></script>
    <script src="./dependencies/jquery-daterange-picker/jquery.daterangepicker.min.js"></script>
    <script src="./dependencies/jquery-timepicker/jquery.timepicker.min.js"></script>
    <script src="./dependencies/datepair/jquery.datepair.min.js"></script>

    <!-- Additional/custom scripts -->
    <script src="./scripts/editor.js?version=16"></script>

    <!-- modal to edit config metadata -->
    <aside class="modal fade" id="editMetadataModal" role="dialog" aria-labelledby="editMetadataTitle">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header px-4" id="editMetadataDiv">
            <h3 class="modal-title" id="editMetadataTitle">
              Edit conference name and dates
            </h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body ps-4 pe-5">
            <div class="mb-3">
              <label for="newName">
                Program name
              </label>
              <input type="text" name="newName" placeholder="Program name (required)" class="form-control my-1" id="newName" required />
            </div>

            <div class="mb-3">
              <label for="newtimezone">
                Timezone
              </label>
              <select class="form-select my-1" id="newtimezone"></select>
            </div>

            <div id="changeDatesDiv" class="mb-3">
              <label for="dateChange">
                Change conference date(s)
              </label>
              <div class="my-1">
                <select id="dateChange" name="dateChange" class="form-select mb-3" onchange="updateNewDates()">
                  <option value="">No date change</option>
                  <option value="shift">Shift dates</option>
                  <option value="add">Add a day</option>
                  <option value="delete">Delete a day</option>
                </select>

                <div id="shiftDateControl" class="row align-items-center">
                  <div class="col-auto pe-0">
                    <label for="shiftDates">
                      Shift dates by
                    </label>
                  </div>
                  <div class="col-auto px-2">
                    <input type="number" id="shiftDates" class="form-control" value="0" min="-365" max="365"
                      onchange="updateNewDates()" oninput="updateNewDates()">
                  </div>
                  <div class="col-auto ps-0">
                    days
                  </div>
                </div>

                <select id="addDayOption" name="addDayOption" class="form-select mb-3 w-50" onchange="updateNewDates()">
                  <option value="" disabled>When do you want to add a day?</option>
                  <option value="before">Before</option>
                  <option value="after">After</option>
                </select>

                <select id="deleteDayOption" name="deleteDayOption" class="form-select mb-3 w-50" onchange="updateNewDates()">
                  <option value="" disabled>Which day do you want to delete?</option>
                  <option value="first">Delete first day</option>
                  <option value="last">Delete last day</option>
                </select>
              </div>
            </div>
            
            <div id="currentOrChangedDates" class="p-4 mt-3">
              <div class="row">
                <div class="col-4 text-end">
                  <strong>
                    Current dates
                  </strong>
                </div>
                <div class="col-7">
                  <span id="originalStartdate"></span> to
                  <span id="originalEnddate"></span>
                </div>
              </div>
              <div id="newDates" class="row mt-1">
                <div class="col-4 text-end">
                  <strong>
                    New dates
                  </strong>
                </div>
                <div class="col-7">
                  <span id="newDisplayStartdate"></span> to <span id="newDisplayEnddate"></span>
                </div>
              </div>
            </div>

            <p class="alert alert-danger mt-3" id="deleteWarning">
              If you delete a day, then all talks currently scheduled on that day will become unscheduled and any sessions will be lost.
            </p>
            <input id="newStartdate" name="newStartdate" type="hidden"/>
            <input id="newEnddate" name="newEnddate" type="hidden"/>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-light btn-sm" data-bs-dismiss="modal">
              Cancel
            </button>
            <button type="button" class="btn btn-success btn-sm" onclick="saveMetadata()">
              Save program
            </button>
          </div>
        </div>
      </div>
    </aside>

    <!-- delete program modal -->
    <div class="modal fade" id="deleteProgramModal" tabindex="-1" role="dialog" aria-labelledby="deleteProgramLabel">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header px-4">
            <h2 id="deleteProgramLabel" class="modal-title">Confirm delete</h2>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body ps-4 pe-5">
            <p>You are about to delete this program from the server. This action cannot be reversed.</p>
            <p>Are you sure you want to delete it?</p>
          </div>
          <div class="modal-footer">
            <p id="delete_status"></p>
            <button type="button" class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-danger" onclick="reallyDeleteProgram();">Delete</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Auth Modal -->
    <div class="modal fade" id="authModal" tabindex="-1" role="dialog" aria-labelledby="authModalLabel">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header px-4">
            <h3 class="modal-title" id="authModalLabel">Log in</h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body ps-4 pe-5">
            <p>
              This app requires you to log in with your IACR reference number
              and password.
            </p>
            <div class="mb-3">
              <label for="iacrref">
                IACR reference number
              </label>
              <input type="text" class="form-control my-1" id="iacrref">
            </div>
            <div class="mb-3">
              <label for="password">
                Password
              </label>
              <input type="password" class="form-control my-1" id="password">
            </div>
            <p class="mt-3">
              If you have forgotten your IACR reference number or password,
              <a target="_blank" href="https://secure.iacr.org/membership/members/update.html">click here to recover it</a>.
            </p>
          </div>
          <div class="modal-footer">
            <p id="login_progress"></p>
            <button type="button" class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
            <button type="button" onClick="doLogin();this.blur()"class="btn btn-success">Log in</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal for import from crossref.org -->
    <aside class="modal fade" id="importDOISelection" role="dialog" aria-labelledby="importDOITitle">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header px-4" id="importDOIDiv">
            <h3 class="modal-title" id="importDOITitle">
              Import DOIs from crossref.org
            </h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body ps-4 pe-5">
            <p>
              This will attempt to import DOI URLs for the papers. However, the matches are not guaranteed to be 100% accurate, as they are not provided when the papers are uploaded.
            </p>
            <p>
              Note that if Springer has not finished processing the papers for this conference, then they will not be available yet. You can always enter URLs individually at any time.
            </p>
            <div class="progress">
              <div id="doiSuccess" class="progress-bar progress-bar-striped progress-bar-animated bg-success" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">0%</div>
              <div id="doiFailure" class="progress-bar progress-bar-striped progress-bar-animated bg-warning" role="progressbar" aria-valuenow="0" area-valuemin="0" aria-valuemax="100" style="width: 0%;">0%</div>
            </div>
          </div>
          <div class="modal-footer">
            <span id="doiStatus"></span>
            <button id="doiCloseBtn" type="button" class="btn btn-sm btn-light" data-bs-dismiss="modal">Cancel</button>
            <button id="doiSearchBtn" type="button" onclick="findDOIs()" class="float-end btn btn-success btn-sm">Search</button>
          </div>
          <div class="form-group importResults" id="importResults">
            <ol id="resultList"></ol>
          </div>
        </div>
      </div>
    </aside>

    <!-- Modal for upload from HotCRP -->
    <aside class="modal fade" id="uploadTalksModal" role="dialog" aria-labelledby="uploadTitle">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header px-4" id="uploadTitleDiv">
            <h3 class="modal-title" id="uploadTitle">
              Upload accepted papers
            </h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body ps-4 pe-5">
            <p>
              If you are a program chair for Crypto, Eurocrypt, Asiacrypt, TCC, or PKC, then there is a menu item inside HotCRP  
              'IACR integration' &#8658; 'Accepted papers'. That will allow you to download the required file. As an alternative, the file may also be found at /json/papers.json on the conference website.
            </p>
            <p>
              For FSE and CHES, you will have four files of accepted papers. This is where you should upload each list to the program editor directly.
            </p>
            <!-- <p>
              The required format is described in <a target="_help" href="./docs/help.html">the help docs</a>.
            </p> -->
            <input id="uploadTalksSelector" class="form-control mb-3" type="file" accept=".json">
            <p id="uploadTalksWarning" class="text-danger">
              Files must be in the format exported from HotCRP under 'IACR integration'.
            </p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-light btn-sm" data-bs-dismiss="modal">Cancel</button>
          </div>
        </div>
      </div>
    </aside>

    <!-- Modal for import for FSE or CHES (from cryptodb) -->
    <aside class="modal fade" id="importTalksModal" role="dialog" aria-labelledby="importTitle">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header px-4">
            <h3 class="modal-title" id="importTitle">
              Import from ToSC or TCHES
            </h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body ps-4 pe-5">
            <p>
              Papers that have already been published by ToSC or TCHES may be imported below.
            </p>
            <div class="mb-3">
              <label for="importSelect">
                Select a journal
              </label>
              <select class="form-select my-1" id="importSelect">
                <option value="" selected disabled></option>
                <option value="tches">Transactions on Cryptographic Hardware and Embedded Systems (TCHES)</option>
                <option value="tosc">Transactions on Symmetric Cryptology (ToSC)</option>
              </select>
            </div>

            <div class="row mb-0">
              <div class="col">
                <label for="importstartdate">
                  Published after
                </label>
                <input type="date" id="importstartdate" name="importstartdate" class="form-control my-1" value="">
              </div>
              <div class="col">
                <label for="importenddate">
                  Published before
                </label>
                <input type="date" id="importenddate" name="importenddate" class="form-control my-1" value="">
              </div>
            </div>
            <small class="form-text mt-1">
              Select a date range of publication for desired papers. Both fields above are optional.
            </small>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-light btn-sm" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-success btn-sm" onclick="importFSEorCHES()">Import papers</button>
          </div>
        </div>
      </div>
    </aside>

    <!-- Modal for warnings and errors -->
    <aside class="modal fade" id="errorBox" role="dialog" aria-labelledby="warningTitle">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header px-4" id="warnBoxTitle">
            <h3 class="modal-title" id="warningTitle">
              Warning
            </h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body ps-4 pe-5">
            <p id="modal-message">
              Something's not quite right here.
            </p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-success btn-sm" data-bs-dismiss="modal">Ok</button>
          </div>
        </div>
      </div>
    </aside>

    <!-- Modal for adding, editing, or deleting a new talk. In case you are adding a talk,
         the delete button is not shown and the talkId field is empty.  -->
    <aside class="modal fade" id="editTalkBox" role="dialog" aria-labelledby="addTalkTitle" tabindex="-1">
      <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header px-4" id="addTalkTitleDiv">
            <h3 class="modal-title" id="addTalkTitle">
              Add a new talk
            </h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body ps-4 pe-5">
            <input id="talkId" type="hidden" value=""/>
            
            <div class="mb-3">
              <label for="newTalkTitle">
                Talk title
              </label>
              <input type="text" name="newTalkTitle" placeholder="Talk title (required)" class="form-control my-1" id="newTalkTitle" required />
              <p id="talkTitleWarning" class="text-danger">
                Talk title is required
              </p>
            </div>

            <div class="mb-3">
              <label for="newTalkAuthor">
                Talk author(s)
              </label>
              <input type="text" name="newTalkAuthor" class="form-control my-1"
                aria-describedby="newAuthorHelp" id="newTalkAuthor" />
              <small id="newAuthorHelp" class="form-text">
                Use BibTeX formatting (i.e. names are separated by and).
              </small>
            </div>

            <div class="mb-3">
              <label for="newTalkAffiliation">
                Author affiliation(s)
              </label>
              <input type="text" name="newTalkAffiliation" class="form-control my-1"
                aria-describedby="newAffiliationHelp" id="newTalkAffiliation" />
              <small id="newAffiliationHelp" class="form-text">
                Enter affiliations for authors, separated by semicolon. If authors share an affiliation, there is no need to enter
                the same institution twice.
              </small>
            </div>

            <div class="mb-3">
              <label for="talkAbstract">
                Abstract
              </label>
              <textarea rows="3" id="talkAbstract" name="talkAbstract" class="form-control my-1" 
              aria-describedby="abstractHelp"
                placeholder="Enter abstract here"></textarea>
              <small id="abstractHelp" class="form-text">
                An abstract is optional.
              </small>
            </div>
            
            <div class="mb-3">
              <label for="talkNote">
                Additional notes
              </label>
              <input type="text" name="talkNote" class="form-control my-1" aria-describedby="talkNoteHelp" id="talkNote" maxlength="77" />
              <small id="talkNoteHelp" class="form-text">
                This is where you might enter additional information
                about the paper. Examples include soft merges, awards,
                name of presenter, etc. This is not intended for
                an abstract.
              </small>
            </div>

            <div class="mb-3">
              <label for="paperUrl">
                Paper URL
              </label>
              <input type="url" name="paperUrl" class="form-control my-1" aria-describedby="paperUrlHelp" id="paperUrl" pattern="https?://.+"/>
              <p id="paperUrlWarning" class="text-danger">
                The url must begin with http or https
              </p>
              <small id="paperUrlHelp" class="form-text">
                These can be imported automatically with the import menu. Do not use ePrint urls.
              </small>
            </div>

            <div class="mb-3">
              <label for="slidesUrl">
                Slides URL
              </label>
              <input type="url" name="slidesUrl" class="form-control my-1" aria-describedby="slidesUrlHelp" id="slidesUrl" pattern="https?://.+"/>
              <p id="slidesUrlWarning" class="text-danger">
                The url must begin with http or https
              </p>
            </div>

            <!-- TODO: set up url for video field -->
            <!-- <div class="mb-3">
              <label for="videoUrl">
                Video URL
              </label>
              <input type="url" name="videoUrl" class="form-control my-1" aria-describedby="videoUrlHelp" id="videoUrl" pattern="https?://.+"/>
              <p id="videoUrlWarning" class="text-danger">
                The url must begin with http or https
              </p>
            </div> -->
            
            <!-- NOTE: the only time this is relevant (and visible) is when you are adding a new talk. It does not 
            appear when editing a talk. -->
            <div class="mb-3" id="categorySelector">
              <label for="newTalkCategory">
                Talk category
              </label>
              <select id="newTalkCategory" class="form-select my-1">
                <option value=""></option>
              </select>
            </div>

            <div class="row mb-3" id="talkTimeSelector">
              <div class="col-6">
                <label for="currentTalkStartTime">
                  Start time
                </label>
                <input type="text" name="startTime" class="form-control time start my-1" id="currentTalkStartTime" autocomplete="off" />
              </div>
              <div class="col-6">
                <label for="currentTalkEndTime">
                  End time
                </label>
                <input type="text" name="endTime" class="form-control time end my-1" id="currentTalkEndTime" autocomplete="off" />
              </div>
              <small class="form-text">
                Specific times are optional. Please note that these are not checked as to whether they actually fit within the
                assigned time slot.
              </small>
            </div>
            
            <div class="mb-3">
              <label for="paperId">
                Paper ID
              </label>
              <input type="text" id="paperId" name="paperId" class="form-control my-1" autocomplete="off" />
              <small class="form-text">
                Typically this is the ID from HotCRP. This field must be unique.
              </small>
            </div>

            <div id="deleteTalkWarning" class="alert alert-danger">
              If you delete this talk, then you cannot recover the data. It will be permanently removed from the app.
            </div>
          </div>  <!-- END modal-body -->
          <div class="modal-footer">
            <button id="talkDeleteButton" type="button" class="btn btn-danger btn-sm float-start" onclick="deleteTalk()">
              Delete talk completely
            </button>
            <button type="button" class="btn btn-light btn-sm" data-bs-dismiss="modal">
              Cancel
            </button>
            <button type="button" class="btn btn-success btn-sm" onclick="saveTalk()">
              Save talk
            </button>
          </div>
        </div>
    </aside>

    <!-- Modal for adding or editing a category. In case you are adding a category,
         the delete button is not shown and the categoryId field is empty.  -->
    <aside class="modal fade" id="editCategoryBox" role="dialog" aria-labelledby="categoryEditorTitle">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header px-4" id="addCategoryTitleDiv">
            <h3 class="modal-title" id="categoryEditorTitle">
              Add category
            </h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body ps-4 pe-5">
            <input id="categoryId" type="hidden" value=""/>
            <div class="mb-3">
              <label for="newCategoryName">
                Category name
              </label>
              <input type="text" name="newCategoryName" placeholder="Category name (required)" class="form-control my-1" id="newCategoryName" required />
            </div>
            <div id="deleteCategoryWarning" class="alert alert-danger">
              If you delete this category, then the talks in this category become uncategorized.
            </div>
          </div>
          <div class="modal-footer">
            <button id="deleteCategoryButton" type="button" class="btn btn-danger btn-sm float-start" onclick="deleteCategory()">
              Delete category
            </button>
            <button type="button" class="btn btn-light btn-sm" data-bs-dismiss="modal">
              Cancel
            </button>
            <button type="button" class="btn btn-success btn-sm" onclick="saveCategory()">
              Update category
            </button>
          </div>
        </div>
      </div>
    </aside>

    <!-- Modal for editing a timeslot -->
    <aside class="modal fade" id="editTimeslot" role="dialog" aria-labelledby="timeEditTitle">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header px-4" id="timeEditTitleDiv">
            <h3 class="modal-title" id="timeEditTitle">
              Edit time slot
            </h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body ps-4 pe-5">
            <!-- NOTE: used only for saving edited time slot to progData -->
            <input type="hidden" id="timeslotDayIndex" value="" />
            <input type="hidden" id="timeslotIndex" value="" />
            <div class="row mb-3" id="timeDiv">
              <div class="col">
                <label for="startTime">Start time</label>
                <input type="text" name="startTime" class="form-control time start" id="currentStartTime" autocomplete="off" />
              </div>
              <div class="col">
                <label for="endTime">End time</label>
                <input type="text" name="endTime" class="form-control time end" id="currentEndTime" autocomplete="off" />
              </div>
            </div>
            <div class="form-check mb-3" id="addTrackToSession">
              <label for="addSession" class="form-check-label">Add a track to this timeslot?</label>
              <input type="checkbox" name="numsessions" id="addSession" class="form-check-input" />
            </div>
            <div class="alert alert-danger" id="deleteTimeslotWarning">
              If you delete this timeslot, then any talks in the session will become unscheduled.
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-light btn-sm" data-bs-dismiss="modal">
              Cancel
            </button>
            <button id="deleteTimeslotButton" type="button" class="btn btn-danger btn-sm float-start" onclick="deleteTimeslot()">
              Delete time slot
            </button>
            <button type="button" class="btn btn-success btn-sm" data-bs-dismiss="modal" onclick="saveTimeslot()">
              Save changes
            </button>
          </div>
        </div>
      </div>
    </aside>

    <!-- Modal for editing a session -->
    <aside class="modal fade" id="editSessionBox" role="dialog" aria-labelledby="editSessionTitle">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header px-4" id="editSessionTitleDiv">
            <h3 class="modal-title" id="editSessionTitle">
              Edit session
            </h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body ps-4 pe-5">
            <!-- NOTE: These are used to look up the session that is being edited. -->
            <input type="hidden" id="currentDayIndex" value="" />
            <input type="hidden" id="currentSlotIndex" value="" />
            <input type="hidden" id="currentSessionIndex" value="" />
            <div class="mb-3">
              <label for="currentSessionTitle">
                Session title
              </label>
              <input type="text" name="sessionTitle" class="form-control my-1" id="currentSessionTitle" required/>
              <p id="sessionTitleWarning" class="text-danger">
                Session title is required
              </p>
            </div>
            <div class="mb-3">
              <label for="currentSessionURL">
                Session information URL
              </label>
              <input type="url" name="currentSessionURL" placeholder="Optional" class="form-control my-1" id="currentSessionURL" 
              aria-describedby="sessInfoHelp" />
              <small id="sessInfoHelp" class="form-text">
                This can be useful for links to things like a map or a website for the location.
              </small>
            </div>
            <div class="mb-3">
              <label for="currentSessionLocation">
                Location
              </label>
              <input type="text" name="currentSessionLocation" placeholder="Optional" class="form-control my-1" id="currentSessionLocation" />
            </div>
            <div class="mb-3">
              <label for="currentSessionModerator">
                Session chair or moderator
              </label>
              <input type="text" name="currentSessionModerator" placeholder="Chair: Alan Turing (optional)" class="form-control" id="currentSessionModerator" />
            </div>
            <div class="form-check mb-3">
              <label class="form-check-label" for="allowTalks">
                Allow talks in this session?
              </label>
              <input type="checkbox" name="allowTalks" id="allowTalks" class="form-check-input">
            </div>
            <div id="singleSessionInstructions" class="mb-3 alert alert-info">
              If you want to delete this session, you must delete the time slot.
            </div>
            <div id="deleteSessionWarning" class="alert alert-danger">
              If you delete this session, then any talks in the session will become unscheduled.
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-light btn-sm" data-bs-dismiss="modal">
              Cancel
            </button>
            <button id="deleteSessionButton" type="button" class="btn btn-danger btn-sm float-start" onclick="deleteSession()">
              Delete session
            </button>
            <button type="button" class="btn btn-success btn-sm" onclick="saveSession()">
              Save session
            </button>
          </div>
        </div>
      </div>
    </aside>

    <!-- Modal for adding a timeslot (creates a blank session(s)) -->
    <aside class="modal fade" id="addTimeslot" role="dialog" aria-labelledby="addTimeslotTitle">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header px-4" id="addTimeslotDiv">
            <h3 class="modal-title" id="addTimeslotTitle">
              Add a time slot
            </h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body ps-4 pe-5">
            <p>
              Time slots are ordered by their start time but may overlap.
            </p>
            <input type="hidden" id="dayIndex" value="" />
            <div id="timeslotDiv" class="row mb-3">
              <div class="col">
                <label for="newStartTime">Start time</label>
                <input type="text" name="startTime" class="form-control time start my-1" id="newStartTime" autocomplete="off" required/>
              </div>
              <div class="col">
                <label for="newEndTime">End time</label>
                <input type="text" name="endTime" class="form-control time end my-1" id="newEndTime" autocomplete="off" required/>
              </div>
              <div id="timeSlotWarning" class="alert alert-danger col-12 mt-2">
                Start and end time are both required.
              </div>
            </div>
            <div class="mb-3">
              <label for="numtracks" class="col-form-label">
                Select the number of tracks
              </label>
              <select name="numtracks" id="selectSessionCount" class="form-select my-1">
                <option value="1">One track</option>
                <option value="2">Two tracks</option>
                <option value="3">Three tracks</option>
              </select>
            </div>
            <div class="form-check mb-3">
              <label for="includeTalks" class="form-check-label">Allow talks in the time slot?</label>
              <input type="checkbox" name="includeTalks" id="includeTalks" class="form-check-input"></input>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-light btn-sm" data-bs-dismiss="modal">
              Cancel
            </button>
            <button type="button" class="btn btn-success btn-sm" onclick="addTimeslotToDay()">
              Add time slot
            </button>
          </div>
        </div>
      </div>
    </aside>

    <!-- modal to download PDF -->
    <div class="modal fade" id="downloadPDFModal" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header px-4">
            <h3 class="modal-title">Download PDF</h3>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body ps-4 pe-5">
            <p>
              The PDF file will be opened in a separate tab.
            </p>
            <p class="alert alert-warning">
              Formatting on paper is a work in progress, and may not be very usable at this time.
            </p>
            <form id="pdfform" method="POST" action="pdf/program.php" target="_blank">
              <input type="hidden" name="json" value="">
              <div class="mb-3">
                <label for="page_format">
                  Page format
                </label>
                <select name="page_format" id="page_format" class="form-select my-1">
                  <option value="Letter">US Letter</option>
                  <option value="Letter-L">US Letter landscape</option>
                  <option value="A4">A4</option>
                  <option value="A4-L">A4 landscape</option>
                  <option value="A0">A0 for posters (841mm x 1189mm)</option>
                  <option value="A1">A1 for posters (594mm x 841mm)</option>
                  <option value="A2">A2 for posters (594mm x 841mm)</option>
                  <option value="A3">A3 for posters (297mm x 420mm)</option>
                  <option value="Legal">US Legal</option>
                  <option value="Tabloid">US Tabloid for posters (11.0 x 17.0 in)</option>
                  <option value="HTML">Crude HTML for printing (not for web use)</option>
                </select>
              </div>
              <div class="form-check">
                <label for="two_column" class="form-check-label">
                  Two column format?
                </label>
                <input name="two_column" id="two_column" type="checkbox" class="form-check-input">
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-light btn-sm" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-success btn-sm" onclick="downloadPDF();">Download PDF</button>
          </div>
        </div>
      </div>
    </div>

  </body>
</html>
